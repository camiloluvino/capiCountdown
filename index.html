<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contador Capibara</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/3d-forest.css">
    <link rel="stylesheet" href="css/admin.css">
</head>

<body>

    <!-- Intro Overlay -->
    <div id="intro-overlay"></div>
    <div class="stars"></div>
    <div class="clouds-container" id="cloudsContainer"></div>
    <div class="meadow"></div>
    <!-- Version footer removed per user request -->
    <button class="theme-toggle" id="themeToggle" title="Cambiar tema">ğŸŒ™</button>
    <button class="play-button" id="playButton" title="Jugar: La Cesta de Regalos">ğŸ®</button>

    <!-- Game Overlay -->
    <div id="game-overlay">
        <div class="game-ui">
            <div class="score-total">Puntos: <span id="score">0</span></div>
            <div class="score-grid" id="scoreDetails">
                <!-- Dynamically populated -->
            </div>
        </div>
        <button class="game-close" id="closeGame">âœ•</button>
        <div id="game-player"></div>
        <!-- Items will be spawned here -->
    </div>

    <!-- Feeding Menu -->
    <div class="feeding-menu">
        <div class="food-item" onclick="feedCapybara('ğŸŠ')">ğŸŠ</div>
        <div class="food-item" onclick="feedCapybara('ğŸ‰')">ğŸ‰</div>
        <div class="food-item" onclick="feedCapybara('ğŸŒ¿')">ğŸŒ¿</div>
        <div class="food-item" onclick="feedCapybara('ğŸ')">ğŸ</div>
    </div>

    <h1>Cuenta Regresiva Capibara</h1>
    <!-- Subtitle removed -->

    <div class="capybara-container">
        <img src="assets/images/capybara.png" alt="Capibara Zen" class="capybara-img" id="capyImage">
    </div>

    <!-- Message of the Day -->
    <div class="message-box" id="dailyMessage">
        ...
    </div>

    <div class="counter-container" id="counter">
        <!-- Bundles generated here -->
    </div>

    <!-- Days text removed -->

    <!-- Hidden Time Travel for User Testing -->
    <details class="debug-panel">
        <summary>âš™ï¸ Viaje en el Tiempo (Debug)</summary>
        <div class="slider-container">
            <label for="timeTravel">Desliza para cambiar el dÃ­a:</label>
            <input type="range" id="timeTravel" min="0" max="60" step="1" value="0">
            <span id="debugDate">Fecha simulada: Hoy</span>
        </div>
        <div id="versionDisplay" style="margin-top: 20px; font-size: 0.9rem; color: #888;">Cargando versiÃ³n...</div>

        <!-- Admin Panel for Notes -->
        <details id="adminPanel" style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px;">
            <summary>ğŸ“ Admin Notas (God Mode)</summary>
            <button id="refreshAdminNotes" style="margin: 5px 0; font-size: 0.8rem;">ğŸ”„ Recargar Lista</button>
            <div id="adminNotesList" class="admin-list">
                <!-- Populated by JS -->
            </div>

            <!-- Hidden Edit Form -->
            <div id="adminEditForm" class="admin-edit-form hidden">
                <h4>Editar Nota</h4>
                <input type="hidden" id="editKey">
                <textarea id="editText" rows="3" placeholder="Contenido"></textarea>
                <input type="datetime-local" id="editTime">
                <div class="admin-actions">
                    <button id="saveEditBtn" class="save-btn">Guardar</button>
                    <button id="cancelEditBtn" class="cancel-btn">Cancelar</button>
                </div>
            </div>
        </details>
    </details>

    <!-- Notes Button -->
    <button class="notes-button" id="notesButton" title="Dedicato: Notas Compartidas">ğŸ“’</button>

    <!-- Notes Overlay -->
    <div id="notes-overlay">
        <div class="notes-container">
            <div class="notes-header">
                <h2>ğŸ“’ Diario Compartido</h2>
                <button id="enter3dBtn" style="background:none; border:none; font-size:1.5rem; cursor:pointer;"
                    title="Ver en el Bosque 3D">ğŸŒ²</button>
                <button class="notes-close" id="closeNotes">âœ•</button>
            </div>
            <div class="notes-messages" id="notesList">
                <!-- Notes will appear here -->
            </div>
            <div class="notes-input-area">
                <input type="text" id="noteInput" placeholder="Escribe algo bonito..." autocomplete="off">
                <button id="sendNote">â¤</button>
            </div>
        </div>
    </div>

    <!-- 3D Forest Experiment Viewport -->
    <div id="forest-viewport">
        <div id="exit-3d-btn" onclick="toggle3DView()">âœ• Salir del Bosque</div>
        <div id="forest-fog"></div>
        <div id="nav-hint">Usa la rueda del ratÃ³n o desliza para caminar</div>
        <div id="forest-world">
            <div class="forest-floor"></div>
            <!-- Notes and trees added here by JS -->
        </div>

        <!-- Hidden Modal for Reading Notes -->
        <div id="note-reading-modal" class="hidden">
            <div class="modal-content">
                <span id="close-modal-btn">âœ•</span>
                <div id="modal-text"></div>
                <div id="modal-meta"></div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK (Version 8 Compat for simplicity in vanilla HTML) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script src="js/3d-forest.js"></script>
    <script src="js/script.js"></script>
</body>

</html>